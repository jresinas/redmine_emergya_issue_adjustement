<div class="splitcontentleft">
<% i = 0 %>
<% split_on = (@issue.custom_field_values.size / 2.0).ceil - 1 %>
<% @issue.custom_field_values.each do |value| %>
  <p><%= custom_field_tag_with_label :issue, value %></p>
<% if i == split_on -%>
</div><div class="splitcontentright">
<% end -%>
<% i += 1 -%>
<% end -%>
</div>
<div style="clear:both;"> </div>

<% if (@issue.tracker_id==ExpositionLevel.getTrackerId('Riesgos')) %>
<script>
  var nivelExposicion = document.getElementById("<%= ExpositionLevel.getCustomFieldId('Nivel de ExposiciÃ³n') %>");
  var nivelExposicionOptions = nivelExposicion.getElementsByTagName('option');
  var impacto = document.getElementById("<%= ExpositionLevel.getCustomFieldId('Impacto') %>");
  var probabilidad = document.getElementById("<%= ExpositionLevel.getCustomFieldId('Probabilidad') %>");

  for (i=0; i<nivelExposicionOptions.length; i++){
    nivelExposicionOptions[i].disabled=true;
  }

  nivelExposicion.onfocus = function(){
    nivelExposicion.blur();
  }
  
  if (window.addEventListener) {  // W3C DOM
    impacto.addEventListener('change',updateExposition,false);
    probabilidad.addEventListener('change',updateExposition,false);
  } else if (window.attachEvent) { // IE DOM
    impacto.attachEvent('onchange',updateExposition);
    probabilidad.attachEvent('onchange',updateExposition);
  }

  function updateExposition(){
    arrayNivelesExposicion = <%= (ExpositionLevel.getExpositionLevelsArray).to_json %>
    
    if (impacto.value!="" && probabilidad.value!=""){
      nivelExposicion.value=arrayNivelesExposicion[impacto.value][probabilidad.value];
      disableExpositionLevelOptions();
    }
  }

  function disableExpositionLevelOptions(){
    for (i=0; i<nivelExposicionOptions.length; i++){
      if (nivelExposicionOptions[i].value==nivelExposicion.value){
        nivelExposicionOptions[i].disabled=false;
      } else {
        nivelExposicionOptions[i].disabled=true;
      }
    }
  }
</script>
<% end %>
